{% extends 'home.html' %} 
{% load static %}
{% block content %}

<h1>{{ item.title }}</h1>

{% if item.is_reserved %}
    {% if item.reserved_by == request.user %}
        <p>You have reserved this gift</p>
        <form action="{% url 'wishlist:cancel_reservation' item.pk %}" method="post">
            {% csrf_token %}
            <button type="submit" style="background-color:red; color:white; padding:8px 12px; border:none; border-radius:5px;">
                ❌ Cancel Reservation
            </button>
        </form>
    {% else %}
        <p>This gift is reserved</p>
    {% endif %}
{% else %}
    {% if not is_owner %}
        <form action="{% url 'wishlist:reserve_item' item.pk %}" method="post">
            {% csrf_token %}
            <button type="submit" style="background-color:green; color:white; padding:8px 12px; border:none; border-radius:5px;">
                🎁 Reserve
            </button>
        </form>
    {% endif %}
{% endif %}

<img src="{% if item.image %}{{ item.image.url }}{% else %}{% static 'images/default-gift.png' %}{% endif %}" 
     alt="{{ item.title }}" 
     style="width:300px; height:300px; object-fit:cover;">

{% if item.price %}
<p>Price: {{ item.price }} UAH</p>
{% endif %}

{% if item.description %}
<p>Description: {{ item.description }}</p>
{% endif %}

{% if item.url %}
<p>🔗 View product: <a href="{{ item.url }}" target="_blank">{{ item.url }}</a></p>
{% endif %}

<!-- Edit/Delete buttons only for the owner -->
{% if is_owner %}
    <p>
        <a href="{% url 'wishlist:item_edit' item.pk %}">Edit</a> | 
        <a href="{% url 'wishlist:item_delete' item.pk %}">Delete</a>
    </p>
{% endif %}

<!-- Посилання повернутися до вішліста -->
<p>
    <a href="{{ item.wishlist.get_absolute_url }}" style="text-decoration:underline;">
        ← Back to Wishlist
    </a>
</p>

{% endblock %}